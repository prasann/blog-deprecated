<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="Rails, form_for, UrlGenerationError">
<meta name="description" content="On a REST model new action, form_for tag breaks and raises UrlGenerationError after upgrading to Rails 4.2">
 <meta content="670156599751120" property="fb:app_id">
<meta property="og:title" content="UrlGenerationError after upgrading to Rails 4.2">
<meta property="og:type" content="website">
<meta property="og:url" content="http://prasans.info/2015/12/url_generation_error_after_upgrading_rails/">
<meta property="og:image" content="/assets/images/profile.jpg">
<meta property="og:description" content="On a REST model new action, form_for tag breaks and raises UrlGenerationError after upgrading to Rails 4.2">
<meta property="og:site_name" content="Feel My Presence">
<meta property="og:locale" content="en"> 
<meta property="article:published_time" content="2015-12-09T00:00:00+00:00">
<meta property="article:author" content="Prasanna"> 
<meta property="og:see_also" content="http://prasans.info/2018/04/add-redux-middleware-dynamically/"> 
<meta property="og:see_also" content="http://prasans.info/2018/03/start-nginx-when-upstream-unavailable/"> 
<meta property="og:see_also" content="http://prasans.info/2018/02/soap-call-in-clojure-compojure-with-saaj/">  

  <title>UrlGenerationError after upgrading to Rails 4.2</title>
  <link rel="stylesheet" type="text/css" href="../../../assets/css/post.css">
  <link rel="alternate" type="application/rss+xml" title="Random Presence" href="http://prasans.info/feed.xml">
</head>

<body>
  <nav class="navbar navbar-fixed-top navbar-default" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
        
        Random Presence
        
      </a>

    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/">Home</a></li>
        <li><a href="https://github.com/prasann">Github</a></li>
        <li><a href="/me">Me</a></li>
        <li><a href="http://feeds.prasans.info/prasans">Feed</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="blog_header">
  
</div>
 <div class="title">
  <h1>UrlGenerationError after upgrading to Rails 4.2</h1>
  <div class="date_tag">
    <div class="date">9 December, 2015.</div>
    <div class="tags">
      <em>Under: 
                 
                <a href="/categories/tech">tech</a> 
                 
                <a href="/categories/rails">rails</a> 
            </em>
    </div>
  </div>
</div>
 <div class="post">
  <p>
    On upgrading my rails app from 4.0 to 4.2.5 i steeped onto a wierd issue where my form_for tag breaks and starts throwing exception.
  </p>
  <p>
    A REST model on new action raised an UrlGenerationError exception because of the form_for tag.
  </p>
  <p>
    For ex: if User is a model my form_for looked like this
  </p>
  <pre class="prettyprint">
    form_for(@user, url: user_path(@user)) do |f|
  </pre>
  <p>
    Raised exception was
  </p>
  <pre class="prettyprint">
    No route matches {:action=>"show", :controller=>"users", :id=>nil} missing required keys: [:id]
  </pre>
  <p>
    The @user object’s id is nil since it’s not yet saved in the database. Previously if it was nil that is been skipped by the the url generation. All these occurrences started throwing errors.
  </p>
  <p>
    I have to change the form_for tag to
  </p>
  <pre class="prettyprint">
    form_for(@user) do |f|
  </pre>
  <p>This posts the form to default users_path.</p>

  <h3>Nested objects:</h3>

  <pre class="prettyprint">
    form_for(@user, url: user_address_path(@user, @address)) do |f|
  </pre>
  <p>was changed to</p>

  <pre class="prettyprint">
    form_for([@user, @address]) do |f|
  </pre>
</div>
 <div class="text-center">
	<a href="http://www.facebook.com/sharer/sharer.php?u=http://prasans.info/2015/12/url_generation_error_after_upgrading_rails/" class="btn-share facebook">Share</a>
	<a href="http://twitter.com/intent/tweet?text=UrlGenerationError after upgrading to Rails 4.2 : http://prasans.info/2015/12/url_generation_error_after_upgrading_rails/" class="btn-share twitter">Tweet</a>
</div>
 <div id="page-navigation">
  <div class="prev-link">
    
    <a href="/2015/05/add_ckeditor_to_rails_pipeline/" title="Previous Post:
Integrating CKEditor with Rails asset pipeline.">&laquo; Integrating CKEditor with Rails asset pipeline.</a> 
  </div>

  <div class="next-link">
    
    <a href="/2016/01/capistrano_set_deployed_revision/" title="next Post:
Set deployed Git revision using Capistrano 3">Set deployed Git revision using Capistrano 3 &raquo; </a> 
  </div>
</div>

  <div id="footer">
	Copyright &copy; 2017 - Prasanna
</div>
<script>
	(function(i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r;
		i[r] = i[r] || function() {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date();
		a = s.createElement(o),
			m = s.getElementsByTagName(o)[0];
		a.async = 1;
		a.src = g;
		m.parentNode.insertBefore(a, m)
	})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

	ga('create', 'UA-19478421-1', 'prasans.info');
	ga('send', 'pageview');
</script>

</body>
<script src="../../../assets/js/application.js"></script>

</html>
